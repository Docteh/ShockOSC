@using OpenShock.ShockOsc.Config
@using OpenShock.ShockOsc.Services
@inject IDialogService Dialog
@inject IDialogService DialogService
@inject ConfigManager ConfigManager
@inject Updater Updater

@code {
    [Parameter]
    public bool Authenticated { get; set; }

    private readonly DialogOptions _dialogOptions = new() { NoHeader = true, DisableBackdropClick = true };

    private void OpenUpdateDialog()
    {
        DialogService.Show<UpdateDialog>("Update", _dialogOptions);
    }

    protected override async Task OnInitializedAsync()
    {
        if (await Updater.CheckUpdate()) OpenUpdateDialog();
    }
}

<MudPaper Style="position: absolute; right: 0">
    @if (Updater.UpdateAvailable)
    {
        <MudTooltip Text="Update">
            <MudButton Color="Color.Primary" @onclick="OpenUpdateDialog" Size="Size.Small" Variant="Variant.Filled" Style="margin: 5px;">
                <MudIcon Icon="@Icons.Material.Filled.Update" />
            </MudButton>
        </MudTooltip>
    }
    @if (Authenticated)
    {
        <MudTooltip Text="Logout">
            <MudButton Color="Color.Primary" @onclick="ConfigManager.SaveAsync" Size=" Size.Small" Variant="Variant.Filled" Style="margin: 5px;">
                <MudIcon Icon="@Icons.Material.Filled.Logout" />
            </MudButton>
        </MudTooltip>
    }
</MudPaper>