@using OpenShock.ShockOsc.Logging
@using OpenShock.ShockOsc.Ui.Components.Layout
@using OpenShock.ShockOsc.Ui.Components.Tabs
@using OpenShock.ShockOsc.Ui.Utils
@using OpenShock.ShockOsc.Config
@inject ISnackbar Snackbar
@inherits LayoutComponentBase

@page "/main"

<MudThemeProvider Theme="ThemeDefinition.ShockOscTheme"/>
<MudDialogProvider/>
<MudSnackbarProvider/>

<MudLayout>
    <UpdateLogout Authenticated="true"/>
    <Logo/>
    
    @* <MudPaper Width="250px" Elevation="0"> *@
    @* <MudNavMenu Margin="Margin.Dense" Color="Color.Primary" Class="pa-2" Rounded="true" > *@
    @*     <MudNavLink Href="/Main" OnClick="() => NavigateTab(Tab.Groups)" Match="NavLinkMatch.All">Groups</MudNavLink> *@
    @* </MudNavMenu> *@
    @* </MudPaper> *@
    @* *@
    @* @switch(_currentTab) *@
    @* { *@
    @*     case Tab.Groups: *@
    @*         <GroupsTab/> *@
    @*         break; *@
    @*     case Tab.Config: *@
    @*         <ConfigTab/> *@
    @*         break; *@
    @*     case Tab.Shockers: *@
    @*         <ShockersTab/> *@
    @*         break; *@
    @*     case Tab.Debug: *@
    @*         <DebugTab/> *@
    @*         break; *@
    @*     case Tab.Logs: *@
    @*         <LogsTab/> *@
    @*         break; *@
    @* } *@
    
    <MudContainer>
        <MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-6" Class="rounded-lg">
            <MudTabPanel Text="Groups">
                <GroupsTab/>
            </MudTabPanel>
            <MudTabPanel Text="Config">
                <ConfigTab/>
            </MudTabPanel>
            <MudTabPanel Text="Shockers">
                <ShockersTab/>
            </MudTabPanel>
            <MudTabPanel Text="Debug">
                <DebugTab/>
            </MudTabPanel>
            <MudTabPanel Text="Logs">
                <LogsTab/>
            </MudTabPanel>
        </MudTabs>
    </MudContainer>

</MudLayout>

@code {

    public enum Tab { Groups, Config, Shockers, Debug, Logs }

    private Tab _currentTab = Tab.Groups;
    
    private void NavigateTab(Tab tab)
    {
        _currentTab = tab;
    }
    
    private void MsgNoty(string msg, Severity severity)
    {
        Snackbar.Add(msg, severity);
    }
    
    protected override void OnInitialized()
    {
        UiLogSink.NotificationAction = MsgNoty;
    }
}