@using OpenShock.ShockOsc.Logging
@using OpenShock.ShockOsc.Ui.Components.Layout
@using OpenShock.ShockOsc.Ui.Components.Tabs
@using Serilog
@using OpenShock.ShockOsc.Ui.Utils
@inject ISnackbar Snackbar
@inherits LayoutComponentBase
@inject ShockOscConfigManager.ShockOscConfig Config

@page "/main"

<MudThemeProvider Theme="ThemeDefinition.ShockOscTheme"/>
<MudDialogProvider/>
<MudSnackbarProvider/>

@code {
    private static readonly ILogger Logger = Log.ForContext(typeof(MainLayout));


}

<style>
    .log.fatal {
        background: linear-gradient(180deg, rgba(2,0,36,0) 0%, rgba(121,9,9,0) 58%, rgba(255,0,0,0.4247899843531162) 100%);
    }
    .log.error {
        background: linear-gradient(180deg, rgba(2,0,36,0) 0%, rgba(121,19,9,0) 58%, rgba(255,44,0,0.4247899843531162) 100%);
    }
    .log.warning {
        background: linear-gradient(180deg, rgba(2,0,36,0) 0%, rgba(118,121,9,0) 58%, rgba(255,254,0,0.42) 100%);
    }
    
    .expanded {
        background: rgba(0,0,0,0.32);
    }
    
    .expanded:hover {
            background: rgba(0,0,0,0.4) !important;
    }
</style>

<MudLayout>
    <UpdateLogout Authenticated="true"/>
    <Logo/>

    @*  <MudCheckBox Class="option-width option-checkbox-height" @bind-Value="_loading" Label="Loading" />
    <MudCheckBox Class="option-width option-checkbox-height" @bind-Value="_authenticated" Label="Authed" /> *@


    <MudContainer>
        <MudTabs @bind-ActivePanelIndex="activePageIndex" Elevation="2" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-6" Class="rounded-lg">
            <MudTabPanel Text="Groups">
                <GroupsTab/>
            </MudTabPanel>
            <MudTabPanel Text="Config">
                <ConfigTab/>
            </MudTabPanel>
            <MudTabPanel Text="Shockers">
                <ShockersTab/>
            </MudTabPanel>
            <MudTabPanel Text="Debug">
                <DebugTab/>
            </MudTabPanel>
            <MudTabPanel Text="Logs">
                <LogsTab/>
            </MudTabPanel>
        </MudTabs>
    </MudContainer>

</MudLayout>

@code {
    private int activePageIndex = 0;
    
    private void MsgNoty(string msg, Severity severity)
    {
        Snackbar.Add(msg, severity);
    }
    
    protected override void OnInitialized()
    {
        UiLogSink.NotificationAction = MsgNoty;
    }
}